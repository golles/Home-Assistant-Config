- id: someone_arrives_home
  alias: Voortuinlamp aan als het donker is en iemand thuis komt
  initial_state: on
  trigger:
    - platform: state
      entity_id: 
        # List all individual residents and not the group
        # as it won't work if someone comes home while someone else is already at home.
        - person.sander
        - person.yuliia
      to: 'home'
  condition:
    condition: or
    conditions:
      - condition: sun
        after: sunset
        after_offset: '+00:30:00'
      - condition: sun
        before: sunrise
        before_offset: '-01:00:00'
  action:
    - service: light.turn_on
      data:
        entity_id: light.voortuin
        profile: helder

    - wait_for_trigger:
      - platform: state
        entity_id: binary_sensor.voordeur_contact
        from: 'on'
        to: 'off'
      timeout:
        minutes: 10
      continue_on_timeout: true

    - service: light.turn_off
      entity_id: light.voortuin

    - service: notify.sander
      data:
        title: 'Voordeur dicht'
        message: 'Voortuin lampje uit!'
        

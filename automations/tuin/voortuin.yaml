- id: someone_arrives_home
  alias: Voortuinlamp aan als het donker is en iemand thuis komt
  initial_state: on
  mode: single
  trigger:
    - platform: state
      entity_id: 
        # List all individual residents and not the group as it won't work if someone comes home while someone else is already at home.
        - person.sander
      from: not_home
      to: home
  condition:
    - condition: numeric_state
      entity_id: sensor.achtertuin_lichtsterkte_illuminance_lux
      below: 10
  action:
    - service: light.turn_on
      data:
        entity_id: light.voortuin
        profile: helder
        transition: 2

    - wait_for_trigger:
      - platform: state
        entity_id: binary_sensor.voordeur_contact
        from: "on"
        to: "off"
      timeout:
        minutes: 15
      continue_on_timeout: true

    - delay:
        seconds: 5

    - service: light.turn_off
      data:
        entity_id: light.voortuin
        transition: 2

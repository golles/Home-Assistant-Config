- id: notification_battery_low_or_full
  alias: "Notificatie: Batterij laag of vol"
  description: Meldingen voor lage of volle batterij, alleen voor apparaten die belangrijk zijn
  mode: single
  trigger:
    - platform: numeric_state
      entity_id:
        - sensor.ipad_mini_van_golles_battery_level
        - sensor.logeerkamer_battery
        - sensor.keuken_battery
        - sensor.tandenborstel_battery
      below: 25
    - platform: numeric_state
      entity_id:
        - sensor.iphone_van_golles_battery_level
        - sensor.ipad_mini_van_golles_battery_level
        - sensor.logeerkamer_battery
        - sensor.keuken_battery
        - sensor.tandenborstel_battery
      above: 99
    - platform: state
      entity_id:
        - binary_sensor.va1788876800_battery_state
        - binary_sensor.va1805654016_battery_state
        - binary_sensor.va1923094528_battery_state
        - binary_sensor.va2677479424_battery_state
        - binary_sensor.va2979272704_battery_state
        - binary_sensor.va3030325248_battery_state
        - binary_sensor.va3382122496_battery_state
        - binary_sensor.va4103542784_battery_state
      from: "off"
      to: "on"
  action:
    - variables:
        device: >-
          {{ device_attr(device_id(trigger.entity_id), "model") }}
        area: >-
          {{ area_name(trigger.entity_id) }}
        state: >-
          {{ iif(trigger.to_state.state | int >= 99, "vol", "leeg") }}

    - alias: Send message
      service: notify.sander
      data:
        title: ğŸ”‹ Batterij {{ state }}
        message: >-
          {{ device ~ " batterij " ~ iif(area != None, "in de " ~ area, "") ~ "is " ~ state }}
        data:
          group: battery
          url: /dashboard-status/batterijen
          tag: >-
            {{ "battery-" ~ trigger.entity_id }}

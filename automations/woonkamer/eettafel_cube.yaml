- id: eettafel_cube
  alias: Eettafel cube
  use_blueprint:
    path: golles/zigbee2mqtt_aqara_magic_cube.yaml
    input:
      remote: sensor.eettafel_cube_action
      side: sensor.eettafel_cube_side

      flip_side_0:
        - service: script.eettafel_on
      flip_side_1:
        - variables:
            stream: https://stream.qmusic.nl/qmusic/mp3
            
        - choose:
            - conditions:
                condition: or
                conditions:
                  - "{{ state_attr('media_player.googlehome6234', 'media_content_id') == None }}"
                  - "{{ stream not in state_attr('media_player.googlehome6234', 'media_content_id') }}"
              sequence:
                - service: script.play_livingroom_radio
                  target:
                    entity_id: media_player.lg_soundbar
                  data:
                    stream: "{{ stream }}"
      flip_side_3:
        - service: script.eettafel_off
      flip_side_4:
        - service: media_player.turn_off
          target:
            entity_id: media_player.lg_soundbar
            
      rotate_left_side_0:
        - service: light.turn_on
          data:
            brightness_step: -25
          target:
            entity_id: light.eettafel
      rotate_right_side_0:
        - service: light.turn_on
          data:
            brightness_step: 25
          target:
            entity_id: light.eettafel

      rotate_left_side_1:
        - service: media_player.volume_down
          target:
            entity_id: media_player.lg_soundbar
      rotate_right_side_1:
        - service: media_player.volume_up
          target:
            entity_id: media_player.lg_soundbar

      shake:
        - service: media_player.volume_mute
          target:
            entity_id: media_player.lg_soundbar
          data:
            is_volume_muted: >-
              {{ not state_attr("media_player.lg_soundbar", "is_volume_muted") }}

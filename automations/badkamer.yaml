- id: auto_badkamer_light_on
  alias: Badkamer lamp automatisch aan
  initial_state: on
  trigger:
    - platform: state
      entity_id: binary_sensor.badkamer_beweging_occupancy
      to: 'on'
  condition:
    - condition: numeric_state
      entity_id: sensor.badkamer_beweging_illuminance
      below: 10
    - condition: state
      entity_id: light.badkamer
      state: 'off'
  action:
    - choose:
      - conditions:
          - condition: template
            value_template: '{{ now().hour < 8 }}' # Between 00:00 - 07:59
        sequence:
          - service: light.turn_on
            data:
              entity_id: light.badkamer
              profile: nachtlampje
          - service: light.turn_on
            data:
              entity_id: light.badkamer
              profile: ontspannen
              transition: 5
      default:
        - service: light.turn_on
          data:
            entity_id: light.badkamer
            profile: helder
            transition: 3

- id: auto_badkamer_light_off
  alias: Badkamer lamp automatisch uit
  initial_state: off # TODO switch on, how to deal with showering?
  trigger:
    - platform: state
      entity_id: binary_sensor.badkamer_beweging_occupancy
      to: 'off'
      for:
        seconds: 90
  condition:
    - condition: state
      entity_id: light.badkamer
      state: 'on'
  action:
    - service: light.turn_off
      data:
        entity_id: light.badkamer
        transition: 3

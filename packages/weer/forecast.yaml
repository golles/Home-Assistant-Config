template:
  - trigger:
      - platform: time_pattern
        minutes: /10
    action:
      - service: weather.get_forecasts
        data:
          type: daily
        target:
          entity_id: weather.knmi_purmerend
        response_variable: forecast
    binary_sensor:
      - name: KNMI regen vandaag
        state: "{{ forecast['weather.knmi_purmerend'].forecast[0].precipitation_probability > 0 }}"
        availability: "{{ is_number(forecast['weather.knmi_purmerend'].forecast[0].precipitation_probability) }}"
    sensor:
      - name: KNMI max temp vandaag
        state: "{{ forecast['weather.knmi_purmerend'].forecast[0].temperature }}"
        availability: "{{ is_number(forecast['weather.knmi_purmerend'].forecast[0].temperature) }}"
        unit_of_measurement: "Â°C"
        device_class: temperature

type: custom:auto-entities
show_empty: false
card:
  type: grid
  title: Let op
card_param: cards
filter:
  template: >
    {%- set data = namespace(entities=[]) -%}

    {% if as_timestamp(now()) <= as_timestamp(state_attr("sensor.p2000_dichtbij", "time")) + 7200 %}
      {%- set data.entities = data.entities + [{
        "type": "button",
        "entity": "sensor.p2000_dichtbij",
        "show_state": "true",
        "show_name": "false"
      }] -%}
    {% endif %}
    
    {% if is_state("binary_sensor.zonnescherm_contact_contact", "on") %}
      {%- set data.entities = data.entities + [{
        "type": "custom:button-card",
        "template": "zonnescherm"
      }] -%}
    {% endif %}
    
    {{ data.entities }}
  include:
    - domain: sensor
      attributes:
        Wastecollector: purmerend
        Days-until: <= 1
      options:
        type: custom:button-card
        template: afvalbeheer

    - attributes:
        device_class: battery
        battery: "< 30"
      options:
        type: button
        show_state: true
    - domain: binary_sensor
      state: "on"
      attributes:
        device_class: battery
      options:
        type: button
        show_state: true
        state_color: false

    - domain: plant
      state: problem
      options:
        type: button
        show_state: true
        state_color: false

    - entity_id: fan.air_purifier
      state: "on"
      options:
        type: custom:button-card
        template: air_purifier

    - entity_id: "sensor.pollen_*"
      state: "*oog" # Matches "Hoog" and "Zeer hoog".
      options:
        type: button
        show_state: true
sort:
  method: name

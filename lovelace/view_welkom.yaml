title: Welkom
path: welkom
panel: false
icon: mdi:home-assistant
badges: []
cards:

  - type: glance
    entities:
      - person.sander
      - entity: group.residents
        name: Thuismodus
      - entity: input_boolean.guest_mode
        name: Gastmodus
        tap_action:
          action: toggle
      - entity: input_boolean.vacation_mode
        name: Vakantiemodus
        tap_action:
          action: toggle

  - type: custom:auto-entities
    show_empty: false
    card:
      title: Let op
      type: entities
    filter:
      template: |
       {%if as_timestamp(now()) <= as_timestamp(state_attr('sensor.p2000_dichtbij', 'time')) + 7200 %}sensor.p2000_dichtbij{%endif%}
      include:
        - domain: sensor
          attributes:
            Wastecollector: purmerend
            Days-until: = 0

  - type: weather-forecast
    entity: weather.huis

  - type: conditional
    conditions:
      - entity: sensor.day_or_night
        state: Night
    card:
      !include cards/lichten_aan.yaml

  - type: conditional
    conditions:
      - entity: sensor.time_of_day
        state: Morning
    card:
      !include cards/ochtend.yaml

  - !include cards/huishoudelijke_apparaten_aan.yaml

  - type: conditional
    conditions:
      - entity: sensor.time_of_day
        state: Evening
    card:
      type: custom:auto-entities
      show_empty: false
      card:
        title: Morgen
        type: entities
      filter:
        template: >
          {{ 
            states.sensor 
              | selectattr('attributes.Wastecollector', 'eq', 'purmerend')
              | selectattr('attributes.Days-until', 'eq', 1)
              | map(attribute='entity_id')
              | first
          }}

  - type: conditional
    conditions:
      - entity: media_player.lg_c9
        state: 'off'
    card:
      !include cards/media_player_lg_soundbar.yaml

  - type: vertical-stack
    cards:
      - type: conditional
        conditions:
          - entity: media_player.stb_arris_uhd
            state_not: 'off'
        card:
          !include cards/media_player_stb_arris_uhd.yaml

      - type: conditional
        conditions:
          - entity: media_player.lg_c9
            state_not: 'off'
        card:
          !include cards/media_player_lg_c9.yaml
      
  - !include cards/batterijen_laag.yaml